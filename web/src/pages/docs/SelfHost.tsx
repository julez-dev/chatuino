import { Link, Meta, Title } from "@solidjs/meta";

export default function SelfHost() {
  return (
    <div>
      <Title>Self-Hosting - Chatuino</Title>
      <Meta
        name="description"
        content="Run your own Chatuino server for Twitch authentication. Docker setup, environment configuration, and Twitch app registration."
      />
      <Link rel="canonical" href="https://chatuino.net/docs/self-host" />
      <h1 class="mb-8 text-3xl font-bold text-nord4">
        <span class="text-nord3">[</span>
        <span class="text-nord8"> Self-Hosting </span>
        <span class="text-nord3">]</span>
      </h1>

      <p class="mb-6 text-nord4">
        Chatuino requires a server component to handle the user authentication
        flow with Twitch.
      </p>

      <p class="mb-6 text-nord4">
        Additionally, the server component serves responses from Twitch API
        endpoints that normally require an authenticated user or app when the
        anonymous account is used to connect to chat.
      </p>

      <p class="mb-6 text-nord4">
        The server component is included in the Chatuino binary.
      </p>

      <section class="mb-12">
        <h2 class="mb-4 text-xl font-semibold text-nord4">Prerequisites</h2>
        <p class="mb-4 text-nord4">
          To self-host Chatuino, you need to register an app with Twitch and
          obtain a{" "}
          <code class="rounded bg-nord1 px-1.5 py-0.5 text-nord8">
            client_id
          </code>{" "}
          and{" "}
          <code class="rounded bg-nord1 px-1.5 py-0.5 text-nord8">
            client_secret
          </code>
          .
        </p>
        <p class="mb-4 text-nord4">
          Register your application in the{" "}
          <a
            href="https://dev.twitch.tv/console/apps"
            target="_blank"
            rel="noopener noreferrer"
            class="text-nord8 hover:text-nord7"
          >
            Twitch Dev Console
          </a>{" "}
          under "Register Your Application".
        </p>
        <p class="mb-4 text-nord4">
          Twitch allows localhost as a valid non-HTTPS redirect URL. Use the
          port that the server will use.
        </p>

        <div class="mb-6 rounded-lg border border-nord2 bg-nord1 p-4">
          <h3 class="mb-2 font-medium text-nord4">Environment Variables</h3>
          <ul class="list-inside list-disc space-y-2 text-nord4">
            <li>
              <code class="text-nord8">CHATUINO_CLIENT_ID</code> - Your Twitch
              application client ID
            </li>
            <li>
              <code class="text-nord8">CHATUINO_CLIENT_SECRET</code> - Your
              Twitch application client secret
            </li>
            <li>
              <code class="text-nord8">CHATUINO_API_HOST</code> - The URL of
              your Chatuino server (e.g., http://localhost:8080)
            </li>
          </ul>
        </div>
      </section>

      <section class="mb-12">
        <h2 class="mb-4 text-xl font-semibold text-nord4">
          Running the Server
        </h2>

        <h3 class="mb-2 text-lg font-medium text-nord4">
          Running the Binary Directly
        </h3>
        <p class="mb-4 text-nord4">
          Run the server by executing the Chatuino binary with the{" "}
          <code class="rounded bg-nord1 px-1.5 py-0.5 text-nord8">server</code>{" "}
          subcommand:
        </p>
        <pre class="mb-6 overflow-x-auto rounded-lg border border-nord2 bg-nord1 p-4 text-sm">
          <code class="text-nord4">
            chatuino --log --human-readable server
            --redirect-url=http://localhost:8080/auth/redirect
          </code>
        </pre>

        <h3 class="mb-2 text-lg font-medium text-nord4">Running with Docker</h3>
        <p class="mb-4 text-nord4">Run the server in a Docker container:</p>
        <pre class="mb-4 overflow-x-auto rounded-lg border border-nord2 bg-nord1 p-4 text-sm">
          <code class="text-nord4">{`docker run -d \\
  -e CHATUINO_CLIENT_SECRET \\
  -e CHATUINO_CLIENT_ID \\
  -e CHATUINO_REDIRECT_URL=http://localhost:8080/auth/redirect \\
  -p 8080:8080 \\
  ghcr.io/julez-dev/chatuino:latest --log server`}</code>
        </pre>

        <div class="rounded-lg border border-nord13 bg-nord13/10 p-4">
          <p class="text-sm text-nord4">
            <strong class="text-nord13">Note:</strong> Don't forget the http://
            prefix in the <code class="text-nord8">CHATUINO_REDIRECT_URL</code>{" "}
            environment variable.
          </p>
        </div>
      </section>

      <section class="mb-12">
        <h2 class="mb-4 text-xl font-semibold text-nord4">
          Launching Chatuino
        </h2>
        <p class="mb-4 text-nord4">
          Once the server is running and{" "}
          <code class="rounded bg-nord1 px-1.5 py-0.5 text-nord8">
            CHATUINO_API_HOST
          </code>{" "}
          is configured, start the Chatuino application:
        </p>
        <pre class="overflow-x-auto rounded-lg border border-nord2 bg-nord1 p-4 text-sm">
          <code class="text-nord4">
            CHATUINO_API_HOST=http://localhost:8080 chatuino
          </code>
        </pre>
      </section>

      <section>
        <h2 class="mb-4 text-xl font-semibold text-nord4">
          Docker Compose Example
        </h2>
        <p class="mb-4 text-nord4">
          For a production setup, you might use Docker Compose:
        </p>
        <pre class="overflow-x-auto rounded-lg border border-nord2 bg-nord1 p-4 text-sm">
          <code class="text-nord4">{`version: "3.8"
services:
  chatuino:
    image: ghcr.io/julez-dev/chatuino:latest
    command: --log server
    environment:
      - CHATUINO_CLIENT_ID=\${CHATUINO_CLIENT_ID}
      - CHATUINO_CLIENT_SECRET=\${CHATUINO_CLIENT_SECRET}
      - CHATUINO_REDIRECT_URL=https://your-domain.com/auth/redirect
    ports:
      - "8080:8080"
    restart: unless-stopped`}</code>
        </pre>
      </section>
    </div>
  );
}
